!function(){var t,e,s,a,o=!1,n=!0,i=!0,l=!1,r=0,c=0,d=!1,h=!1,g=[],u=15,m=[],f=!1,p=!1,v="Yes, carry on",C="Start New Game",y=$("#modallabel"),b=$("#modalmessage"),w=$("#mymodalbtn"),x=$("#combined-modal"),k=$("#best-score"),T=$("#current-score"),E=$(".game-board"),M=$("#btn-new-game"),N=$("#btn-undo"),D=$("#btn-up"),B=$("#btn-left"),L=$("#btn-right"),A=$("#btn-down");function I(){o=!0,i=!0,r=0,h=!1,d=!0,G(),d=!1,g=[],m=[],f=!1,p=!1,$(".game-board div").remove(),setTimeout(function(){U()},50),setTimeout(function(){U()},150)}function Y(){r>c&&(c=r,h=!0)}function G(){if(h&&(k.text(c).addClass("score-animate"),setTimeout(function(){k.removeClass("score-animate")},200),h=!1),d)return T.text(r).addClass("score-animate"),setTimeout(function(){T.removeClass("score-animate")},200),void(d=!1)}function O(t,e){$(".gt-position-style-"+t+"-"+e).remove()}function R(t,e,s){var a="gf-value-style-"+s/2,o="gf-value-style-"+s;d=!0,$(".gt-position-style-"+t+"-"+e).text(s).removeClass(a).addClass(o),2048==s&&(f=!0)}function X(t,e,s,a){var o="gt-position-style-"+t+"-"+e,n="gt-position-style-"+s+"-"+a;$("."+o).addClass(n).removeClass(o)}function S(a,o,n){var l="gt-position-style-"+a+"-"+o,r="gf-value-style-"+n;E.append('<div class="game-tile text-center new-tile"></div>'),$(".new-tile").addClass(l).addClass(r).text(n).removeClass("new-tile"),function(){for(var a,o=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],n=document.getElementsByClassName("game-tile"),l=n.length,r=0;r<l;r++)for(var c=1;c<=4;c++)for(var d=1;d<=4;d++)a="gt-position-style-"+c+"-"+d,$(n[r]).hasClass(a)&&o[c-1][d-1]++;for(c=0;c<4;c++)o[c].sort(),o[c][3]>1&&alert("there are two tiles on a cell ! ! ! This is a bug, please inform the developer :) ");if(16==l){var h,g,u;for(i=!1,r=1;r<=4;r++)for(c=1;c<=4;c++){var m=document.getElementsByClassName("gt-position-style-"+r+"-"+c);h=$(m[0]).text(),m=document.getElementsByClassName("gt-position-style-"+(r+1)+"-"+c),g=$(m[0]).text(),m=document.getElementsByClassName("gt-position-style-"+r+"-"+(c+1)),u=$(m[0]).text(),h!=g&&h!=u||(i=!0)}i||(t="Game Over!",e="No possible move available --\x3e game over! Want to try again?",s=C,y.text(t),b.text(e),w.text(s),x.modal("show"))}}()}function U(){for(var t=[],e=0,s=0;s<4;s++)for(var a=0;a<4;a++){$(".gt-position-style-"+(s+1)+"-"+(a+1)).length||(e++,t.push(s+1,a+1))}var o=Math.floor(Math.random()*e),n=2*(Math.floor(1.25*Math.random())+1);S(t[2*o],t[2*o+1],n)}function W(a){o&&n&&(!function(){for(var t,e,s,a,o=[],n=document.getElementsByClassName("game-tile"),i=0;i<n.length;i++){var l=n[i].className;t=l.indexOf("position-style"),e=parseInt(l.slice(t+15,t+16)),s=parseInt(l.slice(t+17,t+18)),a=parseInt(n[i].textContent),o.push(e),o.push(s),o.push(a)}const r=[...o];g.push(r),g.length>u&&g.shift()}(),m.push(r),m.length-1>u&&m.shift(),function(t){var e,s,a,o,n,i,c,d,h,g;switch(t){case 3:e=3,s=-1,o=1,a=0;break;case 1:e=0,s=1,o=1,a=0;break;case 2:e=3,s=-1,o=0,a=1;break;case 0:e=0,s=1,o=0,a=1}l=!1;for(var u=0;u<4;u++){for(var m=[],f=[],p=0;p<4;p++)m[p]=".gt-position-style-"+((u+1)*o+(p+1)*a)+"-"+((u+1)*a+(p+1)*o),f[p]=$(m[p]).text();if(f[e+0*s]>0&&f[e+0*s]==f[e+1*s]&&(n=(u+1)*o+(e+0*s+1)*a,i=(u+1)*a+(e+0*s+1)*o,c=(u+1)*o+(e+1*s+1)*a,d=(u+1)*a+(e+1*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+1*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n,i),r+=2*f[e+1*s],Y(),l=!0,f[e+0*s]=2*f[e+1*s],f[e+1*s]=""),f[e+2*s]>0&&f[e+2*s]==f[e+3*s]&&(n=(u+1)*o+(e+2*s+1)*a,i=(u+1)*a+(e+2*s+1)*o,c=(u+1)*o+(e+3*s+1)*a,d=(u+1)*a+(e+3*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+3*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n=(u+1)*o+(e+1*s+1)*a,i=(u+1)*a+(e+1*s+1)*o),r+=2*f[e+3*s],Y(),f[e+1*s]=2*f[e+3*s],f[e+2*s]="",f[e+3*s]=""))),f[e+0*s]>0&&f[e+0*s]==f[e+2*s]&&0==f[e+1*s]&&(n=(u+1)*o+(e+0*s+1)*a,i=(u+1)*a+(e+0*s+1)*o,c=(u+1)*o+(e+2*s+1)*a,d=(u+1)*a+(e+2*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+2*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n,i),r+=2*f[e+2*s],Y(),l=!0,f[e+0*s]=2*f[e+2*s],f[e+2*s]="")),f[e+0*s]>0&&f[e+0*s]==f[e+3*s]&&0==f[e+1*s]&&0==f[e+2*s]&&(n=(u+1)*o+(e+0*s+1)*a,i=(u+1)*a+(e+0*s+1)*o,c=(u+1)*o+(e+3*s+1)*a,d=(u+1)*a+(e+3*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+3*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n,i),r+=2*f[e+3*s],Y(),l=!0,f[e+0*s]=2*f[e+3*s],f[e+3*s]="")),f[e+1*s]>0&&f[e+1*s]==f[e+2*s]&&(n=(u+1)*o+(e+1*s+1)*a,i=(u+1)*a+(e+1*s+1)*o,c=(u+1)*o+(e+2*s+1)*a,d=(u+1)*a+(e+2*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+2*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n,i),r+=2*f[e+2*s],Y(),l=!0,f[e+1*s]=2*f[e+2*s],f[e+2*s]="")),f[e+1*s]>0&&f[e+1*s]==f[e+3*s]&&0==f[e+2*s]&&(n=(u+1)*o+(e+1*s+1)*a,i=(u+1)*a+(e+1*s+1)*o,c=(u+1)*o+(e+3*s+1)*a,d=(u+1)*a+(e+3*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+3*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n,i),r+=2*f[e+3*s],Y(),l=!0,f[e+1*s]=2*f[e+3*s],f[e+3*s]="")),f[e+2*s]>0&&f[e+2*s]==f[e+3*s]&&(n=(u+1)*o+(e+2*s+1)*a,i=(u+1)*a+(e+2*s+1)*o,c=(u+1)*o+(e+3*s+1)*a,d=(u+1)*a+(e+3*s+1)*o,$(".gt-position-style-"+n+"-"+i).hasClass("changed")||$(".gt-position-style-"+c+"-"+d).hasClass("changed")||(O(n,i),R(c,d,2*f[e+3*s]),$(".gt-position-style-"+c+"-"+d).addClass("changed"),X(c,d,n,i),r+=2*f[e+3*s],Y(),l=!0,f[e+2*s]=2*f[e+3*s],f[e+3*s]="")),""!=f[e+1*s]||""!=f[e+2*s]||""!=f[e+3*s])for(;""==f[e+0*s];){for(var v=1;v<=3;v++)X(n=(u+1)*o+(h=v+1+e+v*s*2*e/3)*a,i=(u+1)*a+h*o,c=(u+1)*o+(g=h-s)*a,d=(u+1)*a+g*o);1==s?f.shift():f.pop(),1==s?f.push(""):f.unshift(""),l=!0}if(""!=f[e+2*s]||""!=f[e+3*s])for(;""==f[e+1*s];){for(v=2;v<=3;v++)X(n=(u+1)*o+(h=v+1+e+v*s*2*e/3)*a,i=(u+1)*a+h*o,c=(u+1)*o+(g=h-s)*a,d=(u+1)*a+g*o);1==s?f.shift():f.pop(),1==s?f.push(""):f.unshift(""),l=!0}if(""!=f[e+3*s])for(;""==f[e+2*s];){for(v=3;v<=3;v++)X(n=(u+1)*o+(h=v+1+e+v*s*2*e/3)*a,i=(u+1)*a+h*o,c=(u+1)*o+(g=h-s)*a,d=(u+1)*a+g*o);1==s?f.shift():f.pop(),1==s?f.push(""):f.unshift(""),l=!0}}$(".game-board div").removeClass("changed")}(a),l&&(n=!1,$.when(G()).done(function(){setTimeout(function(){U()},250),n=!0}),f&&(p||(t="2048 Reached!",e="You've reached 2048! Congratulations! Do you want to continue?",s=v,y.text(t),b.text(e),w.text(s),x.modal("show")))))}M.click(function(){I()}),N.click(function(){o&&g.length>1&&(!function(){var t=g[g.length-1],e=t.length/3;$(".game-board div").remove();for(var s=0;s<e;s++)S(t[3*s],t[3*s+1],t[3*s+2]);g.pop()}(),r=m[m.length-1],T.text(r),m.pop())}),D.click(function(){W(0)}),B.click(function(){W(1)}),A.click(function(){W(2)}),L.click(function(){W(3)}),w.click(function(){switch(w.text()){case v:p=!0,x.modal("hide");break;case C:x.modal("hide"),I()}}),document.onkeydown=function(t){switch(t.key){case"ArrowUp":(a=D).addClass("imitate-hover"),setTimeout(function(){a.removeClass("imitate-hover")},250),W(0);break;case"ArrowDown":(a=A).addClass("imitate-hover"),setTimeout(function(){a.removeClass("imitate-hover")},250),W(2);break;case"ArrowLeft":(a=B).addClass("imitate-hover"),setTimeout(function(){a.removeClass("imitate-hover")},250),W(1);break;case"ArrowRight":(a=L).addClass("imitate-hover"),setTimeout(function(){a.removeClass("imitate-hover")},250),W(3)}},window.addEventListener("load",function(){var t,e,s,o,n,i,l,r,c=document.getElementById("swipe-area");r=function(t){"none"!=t&&(a.addClass("imitate-hover"),setTimeout(function(){a.removeClass("imitate-hover")},250),W(t))}||function(t){},(l=c).addEventListener("touchstart",function(a){var l=a.changedTouches[0];t="none",o=0,n=0,e=l.pageX,s=l.pageY,i=(new Date).getTime(),a.preventDefault()},!1),l.addEventListener("touchmove",function(t){t.preventDefault()},!1),l.addEventListener("touchend",function(l){var c=l.changedTouches[0];o=c.pageX-e,n=c.pageY-s,(new Date).getTime()-i<=300&&(Math.abs(o)>=80&&Math.abs(n)<=50?o<0?(t=1,a=B):(t=3,a=L):Math.abs(n)>=80&&Math.abs(o)<=50&&(n<0?(t=0,a=D):(t=2,a=A))),r(t),l.preventDefault()},!1)},!1)}();